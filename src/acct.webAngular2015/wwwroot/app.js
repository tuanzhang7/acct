!function(){"use strict";function config($routeProvider,$locationProvider){$routeProvider.when("/",{templateUrl:"/views/home/index.html",controller:"HomeController"}).when("/customer",{templateUrl:"/views/customer/list.html",controller:"CustomerController"}).when("/customer/create",{templateUrl:"/views/customer/create.html",controller:"CustomerCreateController"}).when("/customer/:id",{templateUrl:"/views/customer/detail.html",controller:"CustomerDetailController"}).when("/customer/edit/:id",{templateUrl:"/views/customer/edit.html",controller:"CustomerEditController"}).when("/invoice/:id",{templateUrl:"/views/invoice/detail.html",controller:"InvoiceDetailController"}).when("/GST",{templateUrl:"/views/gst/list.html",controller:"GSTController"}).when("/GST/:id",{templateUrl:"/views/gst/detail.html",controller:"GSTDetailController"}).when("/GST/edit/:id",{templateUrl:"/views/gst/edit.html",controller:"GSTEditController"}).otherwise({redirectTo:"/"}),$locationProvider.html5Mode(!0)}config.$inject=["$routeProvider","$locationProvider"],angular.module("acctApp",["ngRoute","ui.bootstrap","customerServices","invoiceServices","GSTServices"]).constant("settings",{baseUrl:"http://localhost:63267/api",pageSize:10}).config(config).run(["$rootScope",function($rootScope){$rootScope.page={setTitle:function(title){this.title=title}},$rootScope.$on("$routeChangeSuccess",function(event,current,previous){$rootScope.page.setTitle(current.$$route.title)})}])}(),function(){"use strict";angular.module("acctApp").controller("GSTController",["$scope","GSTSrv",function($scope,GSTSrv){$scope.GSTs=null,GSTSrv.list.query({start:0,limit:10}).$promise.then(function(data){$scope.GSTs=data,$scope.page.setTitle("GSTs")})}]).controller("GSTDetailController",["$scope","$routeParams","$location","GSTSrv","invoiceSvc",function($scope,$routeParams,$location,GSTSrv,invoiceSvc){$scope.transactions=invoiceSvc.query({id:$routeParams.id}),$scope.balance=GSTSrv.balance.query({id:$routeParams.id}),$scope.GST=null,GSTSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.GST=data,$scope.page.setTitle($scope.GST.Name)})}]).controller("GSTEditController",["$scope","$routeParams","$location","GSTSrv",function($scope,$routeParams,$location,GSTSrv){$scope.GST=null,GSTSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.GST=data,$scope.page.setTitle($scope.GST.Name)}),$scope.edit=function(){$scope.GST.$save(function(){console.log("saving..."),$location.path("/GST/"+$routeParams.id)},function(error){})}}])}(),function(){"use strict";var GSTServiceModule=angular.module("GSTServices",["ngResource"]);GSTServiceModule.factory("GSTSrv",function($resource,settings){var baseUrl=settings.baseUrl;return{list:$resource(baseUrl+"/GST",{},{query:{method:"GET",params:{},isArray:!0,headers:{}}}),detail:$resource(baseUrl+"/GST/:id",{},{query:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"}},"delete":{method:"DELETE",params:{id:"@id"}}}),balance:$resource(baseUrl+"/GST/:id/balance",{},{query:{method:"GET",params:{id:"@id"}}})}})}(),function(){"use strict";angular.module("acctApp").controller("CustomerController",["$scope","$http","customerSrv","settings",function($scope,$http,customerSrv,settings){function get(currentPage,pageSize){customerSrv.list.query({page:currentPage,pagesize:pageSize},function(data,headers){$scope.customers=data;var Pagination=angular.fromJson(headers("X-Pagination")),TotalCount=Pagination.TotalCount,TotalPages=Pagination.TotalPages;$scope.totalItems=TotalCount,$scope.totalPages=TotalPages})}var pageSize=settings.pageSize;$scope.pageSize=pageSize,$scope.currentPage=1,$scope.maxSize=10,$scope.page.setTitle("Customers"),get($scope.currentPage,pageSize),$scope.pageChanged=function(){get($scope.currentPage,pageSize)}}]).controller("CustomerDetailController",["$scope","$routeParams","$location","customerSrv","invoiceSvc",function($scope,$routeParams,$location,customerSrv,invoiceSvc){$scope.transactions=invoiceSvc.listByCustomer.query({id:$routeParams.id}),$scope.balance=customerSrv.balance.query({id:$routeParams.id}),$scope.customer=null,customerSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.customer=data,$scope.page.setTitle($scope.customer.Name)})}]).controller("CustomerCreateController",["$scope","$routeParams","$location","customerSrv","GSTSrv",function($scope,$routeParams,$location,customerSrv,GSTSrv){$scope.page.setTitle("Create Customer"),$scope.customer=null,$scope.GSTList=null,GSTSrv.list.query().$promise.then(function(data){$scope.GSTList=data,$scope.customer={idmas_GST:data[0].Id}}),$scope.create=function(){console.log($scope.customer.Name),customerSrv.detail.create($scope.customer).$promise.then(function(data){var newId=data.Id;$location.path("/customer/"+newId)})}}]).controller("CustomerEditController",["$scope","$routeParams","$location","customerSrv","GSTSrv",function($scope,$routeParams,$location,customerSrv,GSTSrv){$scope.customer=null,customerSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.customer=data,$scope.page.setTitle($scope.customer.Name)}),$scope.GSTList=GSTSrv.list.query(),$scope.edit=function(){$scope.customer.$save(function(){$location.path("/customer/"+$routeParams.id)},function(error){})}}])}(),function(){"use strict";var customerServiceModule=angular.module("customerServices",["ngResource"]);customerServiceModule.factory("customerSrv",function($resource,settings){var baseUrl=settings.baseUrl;return{list:$resource(baseUrl+"/Customer?page=:page&pagesize=:pagesize",{},{query:{method:"GET",params:{page:"@page",pagesize:"@pagesize"},isArray:!0,headers:{"auth-token":"admin 1qazxsw@"}}}),detail:$resource(baseUrl+"/Customer/:id",{},{create:{method:"POST"},query:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"}},"delete":{method:"DELETE",params:{id:"@id"}}}),balance:$resource(baseUrl+"/customer/:id/balance",{},{query:{method:"GET",params:{id:"@id"}}})}})}(),angular.module("acctApp").directive("orderDetails",function(){return console.log("directive"),{scope:{order:"=order"},templateUrl:function(elem,attr){return"/views/directives/_orderDetails.html"}}}),angular.module("acctApp").directive("orderStatus",function(){return console.log("directive"),{scope:{status:"=status"},templateUrl:function(elem,attr){return"/views/directives/_status.html"}}}),function(){"use strict";angular.module("acctApp").controller("HomeController",["$scope","$http","customerSrv","settings",function($scope,$http,customerSrv,settings){function showChart(year){var url=baseUrl+"/Invoice/GetMonthlyTotal/"+year;$http.get(url).then(function(response){var chartData=response.data;AmCharts.makeChart("chartdiv",{type:"serial",theme:"light",dataProvider:chartData,valueAxes:[{gridColor:"#FFFFFF",gridAlpha:.2,dashLength:0}],gridAboveGraphs:!0,startDuration:1,graphs:[{balloonText:"[[category]]:<b>[[value]]</b>",fillAlphas:.8,lineAlpha:.2,type:"column",valueField:"total"}],chartCursor:{categoryBalloonEnabled:!1,cursorAlpha:0,zoomable:!1},categoryField:"month",categoryAxis:{gridPosition:"start",gridAlpha:0,tickPosition:"start",tickLength:20},exportConfig:{menuTop:0,menuItems:[{icon:"/lib/3/images/export.png",format:"png"}]}})})}function showChartCustomer(year){var url=baseUrl+"/Invoice/GetYearlyTopCustomer/"+year;$.getJSON(url,function(chartData){AmCharts.makeChart("chartdiv_salesby_customer",{type:"pie",theme:"light",legend:{markerType:"circle",position:"right",marginRight:70,autoMargins:!0},dataProvider:chartData,valueField:"total",titleField:"customer",balloonText:"[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>"})})}function showChartSalesman(year){var url=baseUrl+"/Invoice/GetYearlyTopSalesman/"+year;$.getJSON(url,function(chartData){AmCharts.makeChart("chartdiv_salesby_salesman",{type:"pie",theme:"light",legend:{markerType:"circle",position:"right",marginRight:70,autoMargins:!0},dataProvider:chartData,valueField:"total",titleField:"salesman",balloonText:"[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>"})})}var baseUrl=settings.baseUrl;$scope.page.setTitle("Dashboard");var year="2014";$http({method:"GET",url:baseUrl+"/Dashboard",params:{}}).then(function(response){var dashboard=angular.fromJson(response.data);$scope.dashboard=dashboard},function(response){$scope.data=response.data||"Request failed",$scope.status=response.status}),showChart(year),showChartCustomer(year),showChartSalesman(year)}])}(),function(){"use strict";angular.module("acctApp").controller("InvoiceDetailController",["$scope","$routeParams","$location","customerSrv","invoiceSvc",function($scope,$routeParams,$location,customerSrv,invoiceSvc){$scope.invoice=null,invoiceSvc.detail.query({id:$routeParams.id}).$promise.then(function(data){console.log(data),$scope.invoice=data,$scope.page.setTitle("Invoice "+$scope.invoice.OrderNumber)})}])}(),function(){"use strict";var invoiceServiceModule=angular.module("invoiceServices",["ngResource"]);invoiceServiceModule.factory("invoiceSvc",function($resource,settings){var baseUrl=settings.baseUrl;return{list:$resource(baseUrl+"/Customer?page=:page&pagesize=:pagesize",{},{query:{method:"GET",params:{page:"@page",pagesize:"@pagesize"},isArray:!0,headers:{"auth-token":"admin 1qazxsw@"}}}),listByCustomer:$resource(baseUrl+"/invoice/customer/:id",{},{query:{method:"GET",params:{id:"@id"},isArray:!0,headers:{"auth-token":"admin 1qazxsw@"}}}),detail:$resource(baseUrl+"/invoice/:id",{},{create:{method:"POST"},query:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"}},"delete":{method:"DELETE",params:{id:"@id"}}})}})}();