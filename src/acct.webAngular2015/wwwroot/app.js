!function(){"use strict";function config($routeProvider,$locationProvider){$routeProvider.when("/",{templateUrl:"/views/home/index.html",controller:"HomeController"}).when("/customer",{templateUrl:"/views/customer/list.html",controller:"CustomerController"}).when("/customer/create",{templateUrl:"/views/customer/create.html",controller:"CustomerCreateController"}).when("/customer/:id",{templateUrl:"/views/customer/detail.html",controller:"CustomerDetailController"}).when("/customer/edit/:id",{templateUrl:"/views/customer/edit.html",controller:"CustomerEditController"}).when("/invoice",{templateUrl:"/views/invoice/list.html",controller:"InvoiceController"}).when("/invoice/:id",{templateUrl:"/views/invoice/detail.html",controller:"InvoiceDetailController"}).when("/invoice/edit/:id",{templateUrl:"/views/invoice/edit.html",controller:"InvoiceEditController"}).when("/GST",{templateUrl:"/views/gst/list.html",controller:"GSTController"}).when("/GST/:id",{templateUrl:"/views/gst/detail.html",controller:"GSTDetailController"}).when("/GST/edit/:id",{templateUrl:"/views/gst/edit.html",controller:"GSTEditController"}).otherwise({redirectTo:"/"}),$locationProvider.html5Mode(!0)}config.$inject=["$routeProvider","$locationProvider"],angular.module("acctApp",["ngRoute","ngMockE2E","ui.bootstrap","customerServices","invoiceServices","GSTServices"]).constant("settings",{baseUrl:"",pageSize:10}).config(config).config(["datepickerConfig","datepickerPopupConfig",function(datepickerConfig,datepickerPopupConfig){datepickerConfig.showWeeks=!1,datepickerPopupConfig.showButtonBar=!1,datepickerPopupConfig.datepickerPopup="dd/MM/yyyy"}]).run(["$rootScope",function($rootScope){$rootScope.page={setTitle:function(title){this.title=title}},$rootScope.$on("$routeChangeSuccess",function(event,current,previous){$rootScope.page.setTitle(current.$$route.title)})}]).run(function($httpBackend){var customers=[[{Id:6,Name:"2ADVANCED PTE LTD",Address:"10 Admiralty St #04-23,24\r\nNorth Link Building\r\nSingapore 757695",Phone:"NULL",Fax:"NULL",Email:null,ContactName:"Mr Freddy Khong",idmas_GST:2,GST:null,Order:[]},{Id:7,Name:"3A SYSTEM (M & E) PTE LTD",Address:"Blk 37 Defu Lane 10  #03-47\r\nSingapore 529214\r\n",Phone:"6552 1259",Fax:"6552 1760",Email:"eddiegan@malafon.com.sg",ContactName:"Eddie Gan",idmas_GST:2,GST:null,Order:[]},{Id:8,Name:"3A-COOL SERVICES PTE LTD",Address:"Blk 37 Defu Lane 10  #03-47,\r\nSingapore 529214.",Phone:"6552 1259",Fax:"6552 1760",Email:null,ContactName:"Mr. Ang",idmas_GST:2,GST:null,Order:[]},{Id:9,Name:"3G INTEGRATED PTE LTD",Address:"Blk 2,  #03-501,\r\nDefu Lane 10,\r\nSingapore  539183\r\n",Phone:"6281 0306",Fax:"6281 0326",Email:null,ContactName:"Damien Chin",idmas_GST:2,GST:null,Order:[]},{Id:10,Name:"3H AIRCONDITIONING ENGINEERING PTE LTD",Address:"10Admiralty Street\r\n#04-78, North Link Building\r\nSingapore   757695",Phone:"6483 5702",Fax:"6483 5703",Email:"th.yeow@3h-ac.com.sg",ContactName:"Mr.Yeow Teck Huat/Ms Peggy",idmas_GST:2,GST:null,Order:[]},{Id:11,Name:"5 FOOT WAY INN",Address:"227 South Bridge Rd\r\nSingapore 058776",Phone:"6223 8083",Fax:"NULL",Email:null,ContactName:"Mr Wei Hao",idmas_GST:2,GST:null,Order:[]},{Id:12,Name:"883 ENGINEERING PTE. LTD.",Address:"15 Changi North Street 1\r\n#01-26 l-Lofts\r\nSingapore 498765",Phone:"6256 8883 / 6256 2662",Fax:"6256 8833",Email:"munited@singnet.com.sg",ContactName:"Mr Watson / Saifuls",idmas_GST:2,GST:null,Order:[]},{Id:13,Name:"A  SENSOR TECH PTE LTD",Address:"362 Upper Paya Lebar Road #01-14\r\nDa Jin Factory Building \r\nSingapore 534963",Phone:"6287 7951",Fax:"6287 7728",Email:null,ContactName:"Mr Sebastian Ong/ Kelvin Oh",idmas_GST:2,GST:null,Order:[]},{Id:14,Name:"A & JN TECHNICAL SUPPORT PTE LTD",Address:"No 11,Lok Yong Way\r\nSingapore 658077.",Phone:"6265 1728",Fax:"6877 0716/6265 6837",Email:"otm_engg@pacific.net.sg",ContactName:"Mr.Chye Joon Num",idmas_GST:2,GST:null,Order:[]},{Id:15,Name:"A PLUS FOOD PLACE",Address:"New Tech Park 151\r\nLor Chuan #02-12",Phone:"9827 9310",Fax:"NULL",Email:null,ContactName:"Mr Katherine",idmas_GST:2,GST:null,Order:[]},{Id:16,Name:"A- STAR DATA STORAGE INSTITUTE",Address:"Dsi  Building 5 Engineering Drive 1\r\n(Off Kent Ridge Crescent, Nus)\r\nSingapore 117608\r\n\r\n",Phone:"6874 5089/6874 6600",Fax:"6777 8517",Email:null,ContactName:"Mr Lim Kian Guan",idmas_GST:2,GST:null,Order:[]},{Id:17,Name:"A T FORKLIFT REPAIR & SERVICES",Address:"Blk 331 Bukit Batok Streer 33#04-233\r\nSingapore 650331",Phone:"NULL",Fax:"6760 7765",Email:null,ContactName:"Mr See Ai Teck",idmas_GST:2,GST:null,Order:[]},{Id:18,Name:"A.C.E TAI SOON (S) PTE LTD",Address:"11 Lorong 15 Geylang \r\nSingapore 388604",Phone:"6841 3998",Fax:"NULL",Email:null,ContactName:"NULL",idmas_GST:2,GST:null,Order:[]},{Id:19,Name:"A.K.ONG ENGINEERING PTE LTD",Address:"No: 65 Sims Avenue \r\nYi Xiu Factory Building \r\n#01-09\r\nSingapore 387418",Phone:"6846 1611",Fax:"6842 1395",Email:"akongeng@gmail.com",ContactName:"Ms Joe",idmas_GST:2,GST:null,Order:[]},{Id:20,Name:"A.MAX PTE LTD",Address:"16 Kaki Bukit Crescent \r\nSingapore 416247",Phone:"6449 9972",Fax:"6445 1411",Email:null,ContactName:"Ms Esther",idmas_GST:2,GST:null,Order:[]},{Id:21,Name:"A.P.E ELECTRICAL AND AIRECON ENGINEERING",Address:"Blk 111#04-620\r\nTeck Whye Lane\r\nSingapore 680111",Phone:"NULL",Fax:"NULL",Email:null,ContactName:"Mr. David Tee",idmas_GST:2,GST:null,Order:[]},{Id:22,Name:"a/a",Address:"5A ENG KONG TERRACE\r\nSINGAPORE 598977",Phone:"9099 2788",Fax:"6750 2015",Email:null,ContactName:"TEO",idmas_GST:2,GST:null,Order:[]},{Id:23,Name:"A/C-TPL",Address:"No. 96 Mandai Estate \r\nSingapore 729927",Phone:"6362 0660",Fax:"6362 0770",Email:null,ContactName:"Kenny Ng",idmas_GST:2,GST:null,Order:[]},{Id:24,Name:"A\\C",Address:"19, Senoko Ave,\r\nSingapore 758308.",Phone:"6365 2688",Fax:"6365 5956",Email:"eddiegan@malafon.com.sg",ContactName:"Eddie Gan",idmas_GST:2,GST:null,Order:[]},{Id:25,Name:"AAA INTEGRATE PTE LTD",Address:"Blk 63, #05-281\r\nCircuit Road\r\nSingapore 370063",Phone:"NULL",Fax:"NULL",Email:null,ContactName:"Mr KPC Gupthan",idmas_GST:2,GST:null,Order:[]}]],customer={Id:6,Name:"2ADVANCED PTE LTD",Address:"10 Admiralty St #04-23,24\r\nNorth Link Building\r\nSingapore 757695",Phone:"NULL",Fax:"NULL",Email:null,ContactName:"Mr Freddy Khong",idmas_GST:2,GST:null,Order:[]},invocies={};$httpBackend.whenGET(/^\/views\//).passThrough(),$httpBackend.whenGET("/customer?page=1&pagesize=10").respond(function(method,url,data,headers){"application/json;charset=utf-8"==headers["Content-Type"];var pageHeader={TotalCount:2219,TotalPages:111};return[200,customers,{"X-Pagination":pageHeader},"OK"]}),$httpBackend.whenGET("/customer/10").respond(function(method,url,data,headers){return[200,customer,{},"OK"]}),$httpBackend.whenGET("invoice/customer/10").respond(function(method,url,data,headers){return[200,invocies,{},"OK"]})})}(),function(){"use strict";angular.module("acctApp").controller("GSTController",["$scope","GSTSrv",function($scope,GSTSrv){$scope.GSTs=null,GSTSrv.list.query({start:0,limit:10}).$promise.then(function(data){$scope.GSTs=data,$scope.page.setTitle("GSTs")})}]).controller("GSTDetailController",["$scope","$routeParams","$location","GSTSrv","invoiceSvc",function($scope,$routeParams,$location,GSTSrv,invoiceSvc){$scope.transactions=invoiceSvc.query({id:$routeParams.id}),$scope.balance=GSTSrv.balance.query({id:$routeParams.id}),$scope.GST=null,GSTSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.GST=data,$scope.page.setTitle($scope.GST.Name)})}]).controller("GSTEditController",["$scope","$routeParams","$location","GSTSrv",function($scope,$routeParams,$location,GSTSrv){$scope.GST=null,GSTSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.GST=data,$scope.page.setTitle($scope.GST.Name)}),$scope.edit=function(){$scope.GST.$save(function(){console.log("saving..."),$location.path("/GST/"+$routeParams.id)},function(error){})}}])}(),function(){"use strict";var GSTServiceModule=angular.module("GSTServices",["ngResource"]);GSTServiceModule.factory("GSTSrv",function($resource,settings){var baseUrl=settings.baseUrl;return{list:$resource(baseUrl+"/GST",{},{query:{method:"GET",params:{},isArray:!0,headers:{}}}),detail:$resource(baseUrl+"/GST/:id",{},{query:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"}},"delete":{method:"DELETE",params:{id:"@id"}}}),balance:$resource(baseUrl+"/GST/:id/balance",{},{query:{method:"GET",params:{id:"@id"}}})}})}(),function(){"use strict";angular.module("acctApp").controller("CustomerController",["$scope","$http","$location","customerSrv","settings",function($scope,$http,$location,customerSrv,settings){function get(currentPage,pageSize){customerSrv.list.query({page:currentPage,pagesize:pageSize},function(data,headers){console.log(headers("X-Pagination")),console.log(data),$scope.customers=data;var TotalCount=100,TotalPages=10;$scope.totalItems=TotalCount,$scope.totalPages=TotalPages})}var pageSize=settings.pageSize;$scope.pageSize=pageSize,$scope.currentPage=1,$scope.maxSize=10,$scope.page.setTitle("Customers"),get($scope.currentPage,pageSize),$scope.lookup=function(q){return customerSrv.lookup.query({q:q,limit:10}).$promise.then(function(data){return data})},$scope.onSelect=function($item,$model,$label){$scope.$item=$item,$scope.$model=$model,$scope.$label=$label;var id=$item.id;$location.path("/customer/"+id)},$scope.pageChanged=function(){get($scope.currentPage,pageSize)}}]).controller("CustomerDetailController",["$scope","$routeParams","$location","customerSrv","invoiceSvc",function($scope,$routeParams,$location,customerSrv,invoiceSvc){$scope.transactions=invoiceSvc.listByCustomer.query({id:$routeParams.id}),$scope.balance=customerSrv.balance.query({id:$routeParams.id}),$scope.customer=null,customerSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.customer=data,$scope.page.setTitle($scope.customer.Name)})}]).controller("CustomerCreateController",["$scope","$routeParams","$location","customerSrv","GSTSrv",function($scope,$routeParams,$location,customerSrv,GSTSrv){$scope.page.setTitle("Create Customer"),$scope.customer=null,$scope.GSTList=null,GSTSrv.list.query().$promise.then(function(data){$scope.GSTList=data,$scope.customer={idmas_GST:data[0].Id}}),$scope.create=function(){console.log($scope.customer.Name),customerSrv.detail.create($scope.customer).$promise.then(function(data){var newId=data.Id;$location.path("/customer/"+newId)})}}]).controller("CustomerEditController",["$scope","$routeParams","$location","customerSrv","GSTSrv",function($scope,$routeParams,$location,customerSrv,GSTSrv){$scope.customer=null,customerSrv.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.customer=data,$scope.page.setTitle($scope.customer.Name)}),$scope.GSTList=GSTSrv.list.query(),$scope.edit=function(){$scope.customer.$save(function(){$location.path("/customer/"+$routeParams.id)},function(error){})}}])}(),function(){"use strict";var customerServiceModule=angular.module("customerServices",["ngResource"]);customerServiceModule.factory("customerSrv",function($resource,settings){var baseUrl=settings.baseUrl;return{list:$resource(baseUrl+"/customer?page=:page&pagesize=:pagesize",{},{query:{method:"GET",params:{page:"@page",pagesize:"@pagesize"},isArray:!0,headers:{"auth-token":"admin 1qazxsw@"}}}),detail:$resource(baseUrl+"/customer/:id",{},{create:{method:"POST"},query:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"}},"delete":{method:"DELETE",params:{id:"@id"}}}),balance:$resource(baseUrl+"/customer/:id/balance",{},{query:{method:"GET",params:{id:"@id"}}}),lookup:$resource(baseUrl+"/customer/lookup?q=:q&limit=:limit",{},{query:{method:"GET",params:{q:"@q",limit:"@limit"},isArray:!0}})}})}(),angular.module("acctApp").directive("datePicker",function(){function link(scope,element,attrs){scope.status={opened:!1},scope.open=function($event){scope.status.opened=!0}}return{scope:{date:"=date"},templateUrl:function(elem,attr){return"/views/directives/_datePicker.html"},link:link}}),angular.module("acctApp").directive("orderDetails",function(){return{scope:{order:"=order"},templateUrl:function(elem,attr){return"/views/directives/_orderDetails.html"}}}).directive("orderLines",function(){return{scope:{lines:"=lines"},templateUrl:function(elem,attr){return"/views/directives/_orderLines.html"}}}).directive("orderList",function(){return{scope:{orders:"=orders"},templateUrl:function(elem,attr){return"/views/directives/_orderList.html"}}}).directive("orderForm",function(){return{scope:{order:"=order"},templateUrl:function(elem,attr){return"/views/directives/_orderForm.html"}}}),angular.module("acctApp").directive("orderStatus",function(){return{scope:{status:"=status"},templateUrl:function(elem,attr){return"/views/directives/_status.html"}}}),function(){"use strict";angular.module("acctApp").controller("HomeController",["$scope","$http","customerSrv","settings",function($scope,$http,customerSrv,settings){function showChart(year){var url=baseUrl+"/Invoice/GetMonthlyTotal/"+year;$http.get(url).then(function(response){var chartData=response.data;AmCharts.makeChart("chartdiv",{type:"serial",theme:"light",dataProvider:chartData,valueAxes:[{gridColor:"#FFFFFF",gridAlpha:.2,dashLength:0}],gridAboveGraphs:!0,startDuration:1,graphs:[{balloonText:"[[category]]:<b>[[value]]</b>",fillAlphas:.8,lineAlpha:.2,type:"column",valueField:"total"}],chartCursor:{categoryBalloonEnabled:!1,cursorAlpha:0,zoomable:!1},categoryField:"month",categoryAxis:{gridPosition:"start",gridAlpha:0,tickPosition:"start",tickLength:20},exportConfig:{menuTop:0,menuItems:[{icon:"/lib/3/images/export.png",format:"png"}]}})})}function showChartCustomer(year){var url=baseUrl+"/Invoice/GetYearlyTopCustomer/"+year;$.getJSON(url,function(chartData){AmCharts.makeChart("chartdiv_salesby_customer",{type:"pie",theme:"light",legend:{markerType:"circle",position:"right",marginRight:70,autoMargins:!0},dataProvider:chartData,valueField:"total",titleField:"customer",balloonText:"[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>"})})}function showChartSalesman(year){var url=baseUrl+"/Invoice/GetYearlyTopSalesman/"+year;$.getJSON(url,function(chartData){AmCharts.makeChart("chartdiv_salesby_salesman",{type:"pie",theme:"light",legend:{markerType:"circle",position:"right",marginRight:70,autoMargins:!0},dataProvider:chartData,valueField:"total",titleField:"salesman",balloonText:"[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>"})})}var baseUrl=settings.baseUrl;$scope.page.setTitle("Dashboard");var year="2014";$http({method:"GET",url:baseUrl+"/Dashboard",params:{}}).then(function(response){var dashboard=angular.fromJson(response.data);$scope.dashboard=dashboard},function(response){$scope.data=response.data||"Request failed",$scope.status=response.status}),showChart(year),showChartCustomer(year),showChartSalesman(year)}])}(),function(){"use strict";angular.module("acctApp").controller("InvoiceController",["$scope","$http","$location","customerSrv","invoiceSvc","settings",function($scope,$http,$location,customerSrv,invoiceSvc,settings){function get(currentPage,pageSize){invoiceSvc.list.query({page:currentPage,pagesize:pageSize},function(data,headers){$scope.invoices=data;var Pagination=angular.fromJson(headers("X-Pagination")),TotalCount=Pagination.TotalCount,TotalPages=Pagination.TotalPages;$scope.totalItems=TotalCount,$scope.totalPages=TotalPages})}var pageSize=settings.pageSize;$scope.pageSize=pageSize,$scope.currentPage=1,$scope.maxSize=10,$scope.page.setTitle("Invoice"),get($scope.currentPage,pageSize),$scope.pageChanged=function(){get($scope.currentPage,pageSize)},$scope.lookup=function(q){return customerSrv.lookup.query({q:q,limit:10}).$promise.then(function(data){return data})},$scope.onSelect=function($item,$model,$label){$scope.$item=$item,$scope.$model=$model,$scope.$label=$label;var id=$item.id;$location.path("/invoice/"+id)}}]).controller("InvoiceDetailController",["$scope","$routeParams","$location","customerSrv","invoiceSvc",function($scope,$routeParams,$location,customerSrv,invoiceSvc){$scope.invoice=null,invoiceSvc.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.invoice=data,$scope.page.setTitle("Invoice "+$scope.invoice.OrderNumber)})}]).controller("InvoiceEditController",["$scope","$routeParams","$location","customerSrv","invoiceSvc",function($scope,$routeParams,$location,customerSrv,invoiceSvc){$scope.invoice=null,invoiceSvc.detail.query({id:$routeParams.id}).$promise.then(function(data){$scope.invoice=data,$scope.page.setTitle("Edit Invoice "+$scope.invoice.OrderNumber)}),$scope.CustomerList=customerSrv.list.query(),$scope.edit=function(){$scope.invoice.$save(function(){$location.path("/invoice/"+$routeParams.id)},function(error){})},$scope.getCustomer=function(val){return $http.get("//maps.googleapis.com/maps/api/geocode/json",{params:{address:val,sensor:!1}}).then(function(response){return response.data.results.map(function(item){return item.formatted_address})})}}])}(),function(){"use strict";var invoiceServiceModule=angular.module("invoiceServices",["ngResource"]);invoiceServiceModule.factory("invoiceSvc",function($resource,settings){var baseUrl=settings.baseUrl;return{list:$resource(baseUrl+"/invoice?page=:page&pagesize=:pagesize",{},{query:{method:"GET",params:{page:"@page",pagesize:"@pagesize"},isArray:!0,headers:{"auth-token":"admin 1qazxsw@"}}}),listByCustomer:$resource(baseUrl+"/invoice/customer/:id",{},{query:{method:"GET",params:{id:"@id"},isArray:!0,headers:{"auth-token":"admin 1qazxsw@"}}}),detail:$resource(baseUrl+"/invoice/:id",{},{create:{method:"POST"},query:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"}},"delete":{method:"DELETE",params:{id:"@id"}}})}})}();